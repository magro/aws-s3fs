#!/usr/bin/make -f

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# The GNU ChangeLog file is hard linked to debian/changelog, and should only
# be included in the vanilla ./configure ; make ; make install procedure.
export DH_ALWAYS_EXCLUDE=ChangeLog

# Build rule for man1 pages.
%.1 : %.1.src
	REPLACE="$$""{sysconfdir}"; \
	cat $< | sed "s^$$REPLACE^${sysconfdir}^" > $@

# Build rule for man5 pages.
%.5 : %.5.src
	REPLACE="$$""{sysconfdir}"; \
	cat $< | sed "s^$$REPLACE^${sysconfdir}^" > $@

%:
	dh $@ --with autotools_dev

override_dh_auto_configure:
	autoreconf --install --force
	dh_auto_configure --

override_dh_auto_build:
	sed < src/sysconffile.generate-h "s^%sysconfdir%^${sysconfdir}^" > src/sysconffile.h
	dh_auto_build --

override_dh_auto_clean:
	rm -f src/sysconffile.h
	dh_auto_clean --

override_dh_builddeb:
	dh_builddeb -- -Zlzma
